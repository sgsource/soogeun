<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous">
        </script>
    </head>
    <body>
        <div id="str"></div>
        <div id="user"></div>
        <form>
            <select id="genres">
                <option value="Folk">Folk</option>
                <option value="Pop">Pop</option>
                <option value="Rock">Rock</option>
                <option value="Reggae">Reggae</option>
                <option value="Indie">Indie</option>
                <option value="Soul">Soul</option>
                <option value="Dance">Dance</option>
            </select>
            <input type="button" id="button" value="Filter">
        </form>
        <div id="subset"></div>

        <script language="javascript">
            let ls = "";
            let globalData;
            $.get("hw9.json", function (data) {
                globalData = data;
                document.getElementById("str").innerHTML =
                    JSON.stringify(data) + "<br/><br/>";

        		data.forEach(function (song) {
                    ls += song.title  + "<br/>"
                       +  "Artist: "  + song.artist + "<br/>"
                       +  "Genre: "   + song.genre + "<br/>"
                       +  "Released " + song.year + "<br/><br/>"
        			}
                )
            	document.getElementById("user").innerHTML = ls;
        	})
            $("#button").click(filterGenre);

            function filterGenre() {
                let v = document.getElementById("genres").value;
                let ts = "Titles under genre: " + v + "<br/>";

                for (let i = 0; i < globalData.length; i++) {
                    if (containsGenre(v, globalData[i].genre)) {
                        ts += globalData[i].title + "<br/>";
                    }
                }
                document.getElementById("subset").innerHTML = ts;
            }

            // helper function to check if genre \in genres
            function containsGenre(genre, genres) {
                for (let i = 0; i < genres.length; i++) {
                    if (genre == genres[i]) {
                        return true;
                    }
                }
                return false;
            }

        </script>
    </body>
</html>
